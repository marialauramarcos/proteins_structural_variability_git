{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Structural divergence - normal modes\"\noutput: html_document\n---\n\n# Introduction\nIn this report we compare structural divergence along normal mode coordinates. Pn is the divergence along a normal mode relative to the mean.\n\n```{r setup, include = FALSE}\n# set chunk options\nknitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, cache = FALSE)\n```\n\n```{r load-packages}\n# load packages\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(plyr)\nlibrary(quantreg)\nlibrary(bio3d)\n\n# load functions\nsource(file.path(data.dir, \"multiplot.R\"))\nsource(file.path(data.dir, \"my-functions.R\")) \n```\n\n```{r set-my-colors}\n# set my colors\nmyColors = c(\"blue\", \"darkgreen\", \"darkgreen\", \"red\", \"red\") \nnames(myColors) <- c(\"exp\", \"mut\", \"no-selection\", \"medium\", \"selection\")\n```\n\n```{r set-run-variables}\n# general parameters\ntolerance = 1e-10\n\n# set significance factors\nf95 = 1.96\nf99 = 2.6\nf999 = 3.3\n```\n\n```{r set-file-names}\n# set input filenames\n## data\nreference.fname = file.path(data.dir, paste(family, \"_ref.txt\", sep = \"\"))\nprotein_list.fname = file.path(data.dir, paste(family, \"_list.txt\", sep = \"\"))\n\n## profiles to compare\n### Pn\nPn.exp.fname = file.path(data.dir, paste(family, \"_R0_\", R0, \"_beta_no.sel_K.analysis_Keff_out_m.exp.Pn.csv\", sep = \"\"))\nPn.medium.fname = file.path(data.dir, paste(family, \"_R0_\", R0, \"_beta_medium.sel_K.analysis_Keff_out_m.theo.Pn.csv\", sep = \"\"))\nPn.mut.fname = file.path(data.dir,paste(family, \"_R0_\", R0, \"_beta_no.sel_K.analysis_Keff_out_m.theo.Pn.csv\", sep = \"\"))\n\n### energy\nenergy.exp.fname = file.path(data.dir, paste(family, \"_R0_\", R0, \"_beta_no.sel_K.analysis_Keff_out_m.exp.va.csv\", sep = \"\"))\nenergy.medium.fname = file.path(data.dir, paste(family, \"_R0_\", R0, \"_beta_medium.sel_K.analysis_Keff_out_m.theo.va.csv\", sep = \"\"))\nenergy.mut.fname = file.path(data.dir, paste(family, \"_R0_\", R0, \"_beta_no.sel_K.analysis_Keff_out_m.theo.va.csv\", sep = \"\"))\n```\n\n```{r set-reference-protein}\n# which is the reference protein?\nreference = as.character(read.table(reference.fname, header = F)[1, 1])\nif (reference != p.ref) {\n  print(\"Warning: different references\")\n}\n```\n\n```{r set-experimental-protein-names, comment = \"\"}\n# experimental protein names\nprotein.exp = read.table(protein_list.fname, header = F, stringsAsFactors = F)[, 1]\nprotein.exp = protein.exp[protein.exp != reference]\n```\n\n```{r prepare-site-data}\n# prepare the data\nPn.exp = read.csv(Pn.exp.fname, header = T)\nrownames(Pn.exp) = paste(\"exp\", rownames(Pn.exp), sep = \"\")\nenergy.exp = read.csv(energy.exp.fname, header = T)\nrownames(energy.exp) = paste(\"exp\", rownames(energy.exp), sep = \"\")\n\nPn.mut = read.csv(Pn.mut.fname, header = T)\nrownames(Pn.mut) = paste(\"mut\", rownames(Pn.mut), sep = \"\")\nenergy.mut = read.csv(energy.mut.fname, header = T)\nrownames(energy.mut) = paste(\"mut\", rownames(energy.mut), sep = \"\")\n\nPn.medium = read.csv(Pn.medium.fname, header = T)\nrownames(Pn.medium) = paste(\"medium\", rownames(Pn.medium), sep = \"\")\nenergy.medium = read.csv(energy.medium.fname, header = T)\nrownames(energy.medium) = paste(\"medium\", rownames(energy.medium), sep = \"\")\n```\n\n```{r prepare-mode-data}\nmode = seq(ncol(Pn.medium))\n\n# Prepare modeComparison.exp\ntPn.exp = as.data.frame(t(as.matrix(Pn.exp)))\ntPn.exp = cbind(data.frame(\"mode\" = mode), tPn.exp)\nPn.exp.long = melt(tPn.exp, \"mode\", variable.name = \"protein\", value.name = \"Pn\")\n\ntenergy.exp = as.data.frame(t(as.matrix(energy.exp)))\ntenergy.exp = cbind(data.frame(\"mode\" = mode), tenergy.exp)\nenergy.exp.long = melt(tenergy.exp, \"mode\", variable.name = \"protein\", value.name = \"energy\")\nenergy.exp.long$sn2 = 1/energy.exp.long$energy\nmodeComparison.exp = merge(energy.exp.long, Pn.exp.long,by = c(\"mode\", \"protein\"))\n\n# Prepare modeComparison.medium\ntPn.medium = as.data.frame(t(as.matrix(Pn.medium)))\ntPn.medium = cbind(data.frame(\"mode\" = mode), tPn.medium)\nPn.medium.long = melt(tPn.medium, \"mode\", variable.name = \"protein\", value.name = \"Pn\")\n\ntenergy.medium = as.data.frame(t(as.matrix(energy.medium)))\ntenergy.medium = cbind(data.frame(\"mode\" = mode), tenergy.medium)\nenergy.medium.long = melt(tenergy.medium, \"mode\", variable.name = \"protein\", value.name = \"energy\")\nenergy.medium.long$sn2 = 1/energy.medium.long$energy\nmodeComparison.medium = merge(energy.medium.long, Pn.medium.long, by = c(\"mode\", \"protein\"))\n\n# Prepare modeComparison.mut\ntPn.mut = as.data.frame(t(as.matrix(Pn.mut)))\ntPn.mut = cbind(data.frame(\"mode\" = mode), tPn.mut)\nPn.mut.long = melt(tPn.mut, \"mode\", variable.name = \"protein\", value.name = \"Pn\")\n\ntenergy.mut = as.data.frame(t(as.matrix(energy.mut)))\ntenergy.mut = cbind(data.frame(\"mode\" = mode), tenergy.mut)\nenergy.mut.long = melt(tenergy.mut, \"mode\", variable.name = \"protein\", value.name = \"energy\")\nenergy.mut.long$sn2 = 1/energy.mut.long$energy\nmodeComparison.mut = merge(energy.mut.long, Pn.mut.long, by = c(\"mode\", \"protein\"))\n\n# omit Nas\nmodeComparison.exp <- na.omit(modeComparison.exp)\nmodeComparison.medium <- na.omit(modeComparison.medium)\nmodeComparison.mut <- na.omit(modeComparison.mut)\n\n# quantile regression \n\n## fit median and quantiles to experimental data\nfit.exp.rq.5 <- rq(Pn ~ sn2, tau = .5, data = modeComparison.exp, method = \"fn\")\nfit.exp.rq.05 <- rq(Pn ~ sn2, tau = .05, data = modeComparison.exp, method = \"fn\")\nfit.exp.rq.95 <- rq(Pn ~ sn2, tau = .95, data = modeComparison.exp, method = \"fn\")\nmodeComparison.exp$rq.5 = fit.exp.rq.5$fitted.values\nmodeComparison.exp$rq.05 = fit.exp.rq.05$fitted.values\nmodeComparison.exp$rq.95 = fit.exp.rq.95$fitted.values\n\n## fit median and quantiles to simulated data and add them to data.frames\nfit.medium.rq.5 <- rq(Pn ~ sn2, tau = .5, data = modeComparison.medium, method = \"fn\")\nfit.medium.rq.05 <- rq(Pn ~ sn2, tau = .05, data = modeComparison.medium, method = \"fn\")\nfit.medium.rq.95 <- rq(Pn ~ sn2, tau = .95, data = modeComparison.medium, method = \"fn\")\nmodeComparison.medium$rq.5 = fit.medium.rq.5$fitted.values\nmodeComparison.medium$rq.05 = fit.medium.rq.05$fitted.values\nmodeComparison.medium$rq.95 = fit.medium.rq.95$fitted.values\n\n## fit median and quantiles to simulated data and add them to data.frames\nfit.mut.rq.5 <- rq(Pn ~ sn2, tau = .5, data = modeComparison.mut, method = \"fn\")\nfit.mut.rq.05 <- rq(Pn ~ sn2, tau = .05, data = modeComparison.mut, method = \"fn\")\nfit.mut.rq.95 <- rq(Pn ~ sn2, tau = .95, data = modeComparison.mut, method = \"fn\")\nmodeComparison.mut$rq.5 = fit.mut.rq.5$fitted.values\nmodeComparison.mut$rq.05 = fit.mut.rq.05$fitted.values\nmodeComparison.mut$rq.95 = fit.mut.rq.95$fitted.values\n\n# put simulated and experimental data together\nmodeComparison.all.datasets = rbind(data.frame(\"dataset\" = \"exp\", modeComparison.exp),\n                                    data.frame(\"dataset\" = \"mut\", modeComparison.mut),\n                                    data.frame(\"dataset\" = \"medium\", modeComparison.medium))\n\nmodeComparison.all.datasets$dataset = factor(modeComparison.all.datasets$dataset, levels = c(\"exp\", \"mut\", \"medium\"))\n```\n\n### Fitted Pn vs mode energy and mode number\n\nIn this section we compare Pn fitted data. Lines are the median, 0.05 and 0.95 quantiles fit using rq(Pn ~ sn2). sn2 = 1/energy is the expected MSD along mode n. The mean value of Pn should be a linear function of sn2.\n\nHere we show the square deviation along each normal mode (normalized so that = 1) vs. the normal-mode's energy. For the empirical data, we use the actual energy obtained from the Keff for the given comparison. It is this energy that should be used, since it's inverse is the expected value of Pn. Lines are the .5 (median), .05, and .95 quantiles obtained using rq()\n\n```{r Pn-reg-vs-energy}\n\ndat = modeComparison.all.datasets\n\n# Plot Pn vs energy\np.points.rq = ggplot(dat, aes(x = energy, y = Pn, col = dataset)) + \n    geom_point(alpha = .4, size = .2) +\n    geom_line(aes(y = rq.5)) +\n    geom_line(aes(y = rq.05)) +\n    geom_line(aes(y = rq.95)) \n\np = p.points.rq +  \n    labs(x = \"mode energy\", y = \"fitted Pn\") +\n    coord_cartesian(xlim = c(0, 3)) +\n    scale_colour_manual(name = NULL, values = myColors) + \n    scale_fill_manual(name = NULL, values = myColors)\n\np.facet = p + facet_grid(dataset~., switch = \"y\") + theme(legend.position = \"none\")\np.facet\n\n# Plot Pn vs mode\np.points.rq = ggplot(dat, aes(x = mode, y = Pn, col = dataset)) + \n    geom_point(alpha = .4, size = .2) +\n    geom_line(aes(y = rq.5)) +\n    geom_line(aes(y = rq.05)) +\n    geom_line(aes(y = rq.95)) \n\np = p.points.rq +  \n    labs(x = \"mode\", y = \"fitted Pn\") +\n    scale_colour_manual(name = NULL, values = myColors) + \n    scale_fill_manual(name = NULL, values = myColors)\n\np.facet = p + facet_grid(dataset~., switch = \"y\") + theme(legend.position = \"none\")\np.facet\n```\n\n### median Pn and rq.5 vs mode energy and mode number\nIn this section we compare median Pn and rq.5 profiles with mode energy and mode number.\n\n```{r median-reg-vs-mode-energy}\n\ndat = modeComparison.all.datasets\ndat$dataset = revalue(dat$dataset, c(\"medium\" = \"selection\"))\ndat$dataset = revalue(dat$dataset, c(\"mut\" = \"no-selection\"))\n\n# calculate dataset of medians\ndat = ddply(dat,c(\"dataset\", \"mode\"), function(x) {\n    energy.mean = mean(x$energy)\n      Pn.median = median(x$Pn)\n   Pn.median.ci = sort(x$Pn)[qbinom(c(.025, .975), length(x$Pn), 0.5)]\n  Pn.median.min = Pn.median.ci[1] \n  Pn.median.max = Pn.median.ci[2]\n           rq.5 = mean(x$rq.5)\n  data.frame(energy.mean, Pn.median.min, Pn.median.max, Pn.median, rq.5)\n})\n\np = ggplot(dat, aes(x = energy.mean, y = Pn.median, col = dataset, fill = dataset)) +\n    geom_pointrange(aes(ymin = Pn.median.min, ymax = Pn.median.max), size = .2, alpha = .4) +\n    geom_line(aes(y = rq.5))  +\n    labs(x = \"mode energy\", y = \"median Pn\") +\n    scale_colour_manual(name = NULL, values = myColors) + \n    scale_fill_manual(name = NULL, values = myColors) +\n    coord_cartesian(xlim = c(0, 3)) \n\np.facet = p + facet_grid(dataset~., switch = \"y\") + theme(legend.position = \"none\")\np.facet\np + theme(legend.position = \"bottom\")\n\np = ggplot(dat, aes(x = mode, y = Pn.median, col = dataset, fill = dataset)) +\n    geom_pointrange(aes(ymin = Pn.median.min, ymax = Pn.median.max), size = .2, alpha = .4) +\n    geom_line(aes(y = rq.5))  +\n    labs(x = \"mode\", y = \"median Pn\") +\n    scale_colour_manual(name = NULL, values = myColors) + \n    scale_fill_manual(name = NULL, values = myColors)\n\np.facet = p + facet_grid(dataset~., switch = \"y\") + theme(legend.position = \"none\")\np.facet\np + theme(legend.position = \"bottom\")\n```\n\n### Comparison and correlation between mean profiles\n(calculated for all modes)\nIn this section we compare mean Pn profiles.\n\n```{r mean-vs-mode-energy}\n\ndat = modeComparison.all.datasets\ndat$dataset = revalue(dat$dataset, c(\"medium\" = \"selection\"))\ndat$dataset = revalue(dat$dataset, c(\"mut\" = \"no-selection\"))\n\n# calculate dataset of means\ndat = ddply(dat,c(\"dataset\", \"mode\"), function(x) {\n    energy.mean = mean(x$energy)\n    Pn.mean = mean(x$Pn)\n    ndata = sum(!is.na(x$Pn))\n    Pn.se = sd(x$Pn, na.rm = T) / sqrt(ndata)\n    data.frame(energy.mean, Pn.mean, Pn.se)\n})\n\n# plot Pn vs mode\np = ggplot(dat, aes(x = mode, y = Pn.mean, col = dataset, fill = dataset)) +\n    geom_pointrange(aes(ymin = Pn.mean - f95 * Pn.se, ymax = Pn.mean + Pn.se), size = .2, alpha = .4) +\n    labs(x = \"mode\", y = \"<Pn>\") +\n    scale_colour_manual(name = NULL, values = myColors) + \n    scale_fill_manual(name = NULL, values = myColors)\n\np.facet = p + facet_grid(dataset~., switch = \"y\") + theme(legend.position = \"none\")\np.facet\np + theme(legend.position = \"bottom\")\n\n# plot Pn vs 1 / mode energy\np = ggplot(dat, aes(x = (1/energy.mean), y = Pn.mean, col = dataset, fill = dataset)) +\n    geom_point() +\n    labs(x = \"1/lambda_n\", y = \"<Pn>\") +\n    scale_colour_manual(name = NULL, values = myColors) + \n    scale_fill_manual(name = NULL, values = myColors)\n\np.facet = p + facet_grid(dataset~., switch = \"y\") + theme(legend.position = \"none\")\np.facet\np + theme(legend.position = \"bottom\")\n```\n\n(calculated for the first 100 modes)\n\n```{r mean-correlation}\ndat = subset(dat, mode < 101)\ndat.exp = subset(dat, dataset == \"exp\")\ndat.mut = subset(dat,dataset == \"no-selection\")\ndat.medium = subset(dat,dataset == \"selection\")\n\n# correlations between Pn profiles and the fluctuation of modes sn2 = 1/lambda_n\nr.exp = cor(dat.exp$Pn.mean, (1/dat.exp$energy.mean))\nr.mut = cor(dat.mut$Pn.mean, (1/dat.mut$energy.mean))\nr.medium = cor(dat.medium$Pn.mean, (1/dat.medium$energy.mean))\ncor.df = data.frame(\"comparison Pn-Sn2\" = c(\"exp\", \"mut\", \"medium\"),\n                             \"R\" = c(r.exp, r.mut, r.medium))\nknitr::kable(cor.df, digits = 2)\n\n# plots Pn vs sn2\npar(pty = \"s\")\n\nlayout(matrix(1:3, 1, 3))\n\nplot(y = dat.exp$Pn.mean, x = (1/dat.exp$energy.mean), xlab = \"1/lambda_n\", ylab = \"<Pn> experimental\")\nfluc = (1/dat.exp$energy.mean)\nlm = lm(dat.exp$Pn.mean ~ fluc)\nabline(lm)\nlegend(\"topleft\", paste (\"r = \", round(r.exp, digits = 2)), bty = \"n\")\n\nplot(y = dat.mut$Pn.mean, x = (1/dat.mut$energy.mean), xlab = \"1/lambda_n\", ylab = \"<Pn> no-selection\")\nfluc = (1/dat.mut$energy.mean)\nlm = lm(dat.mut$Pn.mean ~ fluc)\nabline(lm)\nlegend(\"topleft\", paste (\"r = \", round(r.mut, digits = 2)), bty = \"n\")\n\nplot(y = dat.medium$Pn.mean, x = (1/dat.medium$energy.mean), xlab = \"1/lambda_n\", ylab = \"<Pn> selection\")\nfluc = (1/dat.medium$energy.mean)\nlm = lm(dat.medium$Pn.mean ~ fluc)\nabline(lm)\nlegend(\"topleft\", paste (\"r = \", round(r.medium, digits = 2)), bty = \"n\")\n\n# correlations between Pn profiles\nr.exp.mut = cor(dat.exp$Pn.mean, dat.mut$Pn.mean)\nr.exp.medium = cor(dat.exp$Pn.mean, dat.medium$Pn.mean)\nr.mut.medium = cor(dat.mut$Pn.mean, dat.medium$Pn.mean)\n\ncor.df = data.frame(\"comparison Pn 100 modes\" = c(\"exp vs mut\", \"exp vs medium\", \"mut vs medium\"),\n                    \"R\" = c(r.exp.mut, r.exp.medium, r.mut.medium))\nknitr::kable(cor.df, digits = 2)\n\n# plot Pn profiles\npar(pty = \"s\")\n\nlayout(matrix(1:3, 1, 3))\n\nplot(x = dat.mut$Pn.mean, \n     y = dat.exp$Pn.mean, \n     xlab = \"<Pn> no-selection\", \n     ylab = \"<Pn> experimental\") \nlm = lm(dat.exp$Pn.mean ~ dat.mut$Pn.mean)\nabline(lm)\nlegend(\"topleft\", paste (\"r = \", round(r.exp.mut, digits = 2)), bty = \"n\")\n\nplot(x = dat.medium$Pn.mean, \n     y = dat.exp$Pn.mean, \n     xlab = \"<Pn> selection\", \n     ylab = \"<Pn> experimental\") \nlm = lm(dat.exp$Pn.mean ~ dat.medium$Pn.mean)\nabline(lm)\nlegend(\"topleft\", paste (\"r = \", round(r.exp.medium, digits = 2)), bty = \"n\")\n\nplot(x = dat.mut$Pn.mean, \n     y = dat.medium$Pn.mean, \n     xlab = \"<Pn> no-selection\", \n     ylab = \"<Pn> selection\")\nlm = lm(dat.medium$Pn.mean ~ dat.mut$Pn.mean)\nabline(lm)\nlegend(\"topleft\", paste (\"r = \", round(r.mut.medium, digits = 2)), bty = \"n\")\n```\n\n### Comparison and correlation between median mode profiles\n(calculated for all modes)\nIn this section we compare median Pn profiles.\n\n```{r median-vs-mode-energy}\n\ndat = modeComparison.all.datasets\ndat$dataset = revalue(dat$dataset, c(\"medium\" = \"selection\"))\ndat$dataset = revalue(dat$dataset, c(\"mut\" = \"no-selection\"))\n\n# calculate dataset of medians\ndat = ddply(dat,c(\"dataset\", \"mode\"), function(x) {\n    energy.mean = mean(x$energy)\n    Pn.median = median(x$Pn)\n    Pn.median.ci = sort(x$Pn)[qbinom(c(.025, .975), length(x$Pn), 0.5)]\n    Pn.median.min = Pn.median.ci[1]\n    Pn.median.max = Pn.median.ci[2]\n    data.frame(energy.mean, Pn.median, Pn.median.min, Pn.median.max)\n})\n\n# plot Pn vs mode\np = ggplot(dat, aes(x = mode, y = Pn.median, col = dataset, fill = dataset)) +\n    geom_pointrange(aes(ymin = Pn.median.min, ymax = Pn.median.max), size = .2, alpha = .4) +\n    labs(x = \"mode\", y = \"median.Pn\") +\n    scale_colour_manual(name = NULL, values = myColors) + \n    scale_fill_manual(name = NULL, values = myColors)\n\np.facet = p + facet_grid(dataset~., switch = \"y\") + theme(legend.position = \"none\")\np.facet %+% subset(dat,dataset == \"exp\")\np.facet %+% subset(dat,dataset == \"no-selection\")\np.facet %+% subset(dat,dataset == \"selection\")\np.facet\np + theme(legend.position = \"bottom\")\n\n# plot Pn vs mode energy\np = ggplot(dat, aes(x = (1/energy.mean), y = Pn.median, col = dataset, fill = dataset)) +\n    geom_point() +\n    labs(x = \"1/lambda_n\", y = \"median Pn\") +\n    scale_colour_manual(name = NULL, values = myColors) + \n    scale_fill_manual(name = NULL, values = myColors)\n\np.facet = p + facet_grid(dataset~., switch = \"y\") + theme(legend.position = \"none\")\np.facet\np + theme(legend.position = \"bottom\")\n```\n\n(calculated for the first 100 modes)\n\n```{r median-correlation}\ndat = subset(dat, mode < 101)\ndat.exp = subset(dat, dataset == \"exp\")\ndat.mut = subset(dat,dataset == \"no-selection\")\ndat.medium = subset(dat,dataset == \"selection\")\n\n# correlations between Pn profiles and the fluctuation of modes sn2 = 1/lambda_n\nr.exp = cor(dat.exp$Pn.median, (1/dat.exp$energy.mean))\nr.mut = cor(dat.mut$Pn.median, (1/dat.mut$energy.mean))\nr.medium = cor(dat.medium$Pn.median, (1/dat.medium$energy.mean))\ncor.df = data.frame(\"comparison Pn-Sn2\" = c(\"exp\", \"mut\", \"medium\"),\n                             \"R\" = c(r.exp, r.mut, r.medium))\nknitr::kable(cor.df, digits = 2)\n\n# plots Pn vs sn2\npar(pty = \"s\")\n\nlayout(matrix(1:3, 1, 3))\n\nplot(y = dat.exp$Pn.median, x = (1/dat.exp$energy.mean), xlab = \"1/lambda_n\", ylab = \"median.Pn experimental\")\nfluc = (1/dat.exp$energy.mean)\nlm = lm(dat.exp$Pn.median ~ fluc)\nabline(lm)\nlegend(\"topleft\", paste (\"r = \", round(r.exp, digits = 2)), bty = \"n\")\n\nplot(y = dat.mut$Pn.median, x = (1/dat.mut$energy.mean), xlab = \"1/lambda_n\", ylab = \"median.Pn no-selection\")\nfluc = (1/dat.mut$energy.mean)\nlm = lm(dat.mut$Pn.median ~ fluc)\nabline(lm)\nlegend(\"topleft\", paste (\"r = \", round(r.mut, digits = 2)), bty = \"n\")\n\nplot(y = dat.medium$Pn.median, x = (1/dat.medium$energy.mean), xlab = \"1/lambda_n\", ylab = \"median.Pn selection\")\nfluc = (1/dat.medium$energy.mean)\nlm = lm(dat.medium$Pn.median ~ fluc)\nabline(lm)\nlegend(\"topleft\", paste (\"r = \", round(r.medium, digits = 2)), bty = \"n\")\n\n# correlations between Pn profiles\nr.exp.mut = cor(dat.exp$Pn.median, dat.mut$Pn.median)\nr.exp.medium = cor(dat.exp$Pn.median, dat.medium$Pn.median)\nr.mut.medium = cor(dat.mut$Pn.median, dat.medium$Pn.median)\n\ncor.df = data.frame(\"comparison Pn 100 modes\" = c(\"exp vs mut\", \"exp vs medium\", \"mut vs medium\"),\n                    \"R\" = c(r.exp.mut, r.exp.medium, r.mut.medium))\nknitr::kable(cor.df, digits = 2)\n\n# plot Pn profiles\npar(pty = \"s\")\n\nlayout(matrix(1:3, 1, 3))\n\nplot(x = dat.mut$Pn.median, \n     y = dat.exp$Pn.median, \n     xlab = \"median.Pn no-selection\", \n     ylab = \"median.Pn experimental\") \nlm = lm(dat.exp$Pn.median ~ dat.mut$Pn.median)\nabline(lm)\nlegend(\"topleft\", paste (\"r = \", round(r.exp.mut, digits = 2)), bty = \"n\")\n\nplot(x = dat.medium$Pn.median, \n     y = dat.exp$Pn.median, \n     xlab = \"median.Pn selection\", \n     ylab = \"median.Pn experimental\") \nlm = lm(dat.exp$Pn.median ~ dat.medium$Pn.median)\nabline(lm)\nlegend(\"topleft\", paste (\"r = \", round(r.exp.medium, digits = 2)), bty = \"n\")\n\nplot(x = dat.mut$Pn.median, \n     y = dat.medium$Pn.median, \n     xlab = \"median.Pn no-selection\", \n     ylab = \"median.Pn selection\")\nlm = lm(dat.medium$Pn.median ~ dat.mut$Pn.median)\nabline(lm)\nlegend(\"topleft\", paste (\"r = \", round(r.mut.medium, digits = 2)), bty = \"n\")\n```",
    "created" : 1511733906061.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3031028645",
    "id" : "889C0B84",
    "lastKnownWriteTime" : 1510445526,
    "last_content_update" : 1510445526,
    "path" : "C:/Users/María Laura/Desktop/proteins_structural_variability_git/analysis-normal-modes.Rmd",
    "project_path" : "analysis-normal-modes.Rmd",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}
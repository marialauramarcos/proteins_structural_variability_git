{
    "collab_server" : "",
    "contents" : "\n```{r setup, include = FALSE}\n# set chunk options\nknitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)\n```\n\n# Introduction\nIn this report we compare experimental and theoretical SDi profiles and SDi profiles with MSFi and 1/CN. We show the figures of all families.\nThen, we compare correlations between SDi profiles with the number of proteins of the family and the sites of p.ref. Finally, we comapre correlations obtained for SDi theo profiles with correlations obtained for LPD with the same R0 (12.5). \n\n```{r load-packages}\n# load packages\nlibrary(png)\n```\n\n```{r read-input}\n# read input\ninput.fname <- \"input_MainReport.csv\"\ninput <- read.csv(input.fname)\n```\n\n## exp SDi vs theo SDi\n```{r plot-sqrt-SDi, fig.height=20}\n  layout(matrix(1:24, 8, 3, byrow = T))\n\n  # satart a loop for each family\nfor (f in (1:nrow(input))) { \n  family <- as.character(input$family)[f]\n  p.ref <- as.character(input$p.ref)[f]\n\n  d = read.csv(file.path(data.dir, paste(family, \"_\", p.ref, \"_R0_\", R0, \"d.SD.csv\", sep = \"\")))\n\n  # get subsets\n  d.exp = subset(d, dataset == \"exp\")\n  d.mut = subset(d, dataset == \"no-selection\")\n  d.medium = subset(d, dataset == \"selection\")\n\n  # calculate Pearson correlation\n  r.exp.mut = cor(sqrt(d.exp$mean.SD), sqrt(d.mut$mean.SD))\n  r.exp.medium = cor(sqrt(d.exp$mean.SD), sqrt(d.medium$mean.SD))\n  r.mut.medium = cor(sqrt(d.mut$mean.SD), sqrt(d.medium$mean.SD))\n\n  # plots\n  par(pty = \"s\")\n\n  plot(x = (sqrt(d.mut$mean.SD)), \n       y = (sqrt(d.exp$mean.SD)), \n       xlab = \"sqrt <SDi> no-selection\", \n       ylab = \"sqrt <SDi> experimental\") \n  lm = lm(sqrt(d.exp$mean.SD) ~ sqrt(d.mut$mean.SD))\n  legend(\"topleft\", paste (\"r = \", round(r.exp.mut, digits = 2)), bty = \"n\")\n\n  plot(x = (sqrt(d.medium$mean.SD)), \n       y = (sqrt(d.exp$mean.SD)), \n       xlab = \"sqrt <SDi> selection\", \n       ylab = \"sqrt <SDi> experimental\",\n       main = family) \n  lm = lm(sqrt(d.exp$mean.SD) ~ sqrt(d.medium$mean.SD)) \n  legend(\"topleft\", paste (\"r = \", round(r.exp.medium, digits = 2)), bty = \"n\")\n\n  plot(x = (sqrt(d.mut$mean.SD)), \n       y = (sqrt(d.medium$mean.SD)), \n       xlab = \"sqrt <SDi> no-selection\", \n       ylab = \"sqrt <SDi> selection\")\n  lm = lm(sqrt(d.medium$mean.SD) ~ sqrt(d.mut$mean.SD))\n  legend(\"topleft\", paste (\"r = \", round(r.mut.medium, digits = 2)), bty = \"n\")\n}\n```\n\n## SDi vs MSF\n```{r plot-sqrt-SDi-MSF, fig.height=20}\n  layout(matrix(1:24, 8, 3, byrow = T))\n\n  # satart a loop for each family\nfor (f in (1:nrow(input))) { \n  family <- as.character(input$family)[f]\n  p.ref <- as.character(input$p.ref)[f]\n\n  d = read.csv(file.path(data.dir, paste(family, \"_\", p.ref, \"_R0_\", R0, \"d.SD.csv\", sep = \"\")))\n  MSF.p.ref = read.csv(file.path(data.dir, paste(family, \"_\", p.ref, \"_R0_\", R0, \"MSF.csv\", sep = \"\")))[, 2]\n\n  # extract means\n  d.exp = subset(d, dataset == \"exp\")\n  d.mut = subset(d, dataset == \"no-selection\")\n  d.medium = subset(d, dataset == \"selection\")\n\n  # correlations\n  r.exp = cor(sqrt(d.exp$mean.SD), sqrt(MSF.p.ref))\n  r.medium = cor(sqrt(d.medium$mean.SD), sqrt(MSF.p.ref))\n  r.mut = cor(sqrt(d.mut$mean.SD), sqrt(MSF.p.ref))\n\n  # plots\n  par(pty = \"s\")\n\n  plot(y = (sqrt(d.exp$mean.SD)), x = sqrt(MSF.p.ref), ylab = \"sqrt <SDi> experimental\", xlab = \"sqrt MSFi\")\n  lm = lm((sqrt(d.exp$mean.SD)) ~ sqrt(MSF.p.ref))\n  legend(\"topleft\", paste (\"r = \", round(r.exp, digits = 2)), bty = \"n\")\n\n  plot(y = (sqrt(d.mut$mean.SD)), x = sqrt(MSF.p.ref), ylab = \"sqrt <SDi> no-selection\", xlab = \"sqrt MSFi\", main = family) \n  lm = lm((sqrt(d.mut$mean.SD)) ~ sqrt(MSF.p.ref))\n  legend(\"topleft\", paste (\"r = \", round(r.mut, digits = 2)), bty = \"n\")\n\n  plot(y = (sqrt(d.medium$mean.SD)), x = sqrt(MSF.p.ref), ylab = \"sqrt <SDi> selection\", xlab =   \"sqrt MSFi\")\n  lm = lm((sqrt(d.medium$mean.SD)) ~ sqrt(MSF.p.ref))\n legend(\"topleft\", paste (\"r = \", round(r.medium, digits = 2)), bty = \"n\")\n}\n```\n\n## SDi vs 1/CN\n```{r plot-sqrt-SDi-1/CN, fig.height=20}\n  layout(matrix(1:24, 8, 3, byrow = T))\n\n  # satart a loop for each family\nfor (f in (1:nrow(input))) { \n  family <- as.character(input$family)[f]\n  p.ref <- as.character(input$p.ref)[f]\n\n  d = read.csv(file.path(data.dir, paste(family, \"_\", p.ref, \"_R0_\", R0, \"d.SD.csv\", sep = \"\")))\n  CN = read.csv(file.path(data.dir, paste(family, \"_\", p.ref, \"_R0_\", R0, \"CN.csv\", sep = \"\")))[, 2]\n\n  # extract means\n  d.exp = subset(d, dataset == \"exp\")\n  d.mut = subset(d, dataset == \"no-selection\")\n  d.medium = subset(d, dataset == \"selection\")\n\n  # correlations\n  r.exp = cor(sqrt(d.exp$mean.SD), sqrt(1/CN))\n  r.medium = cor(sqrt(d.medium$mean.SD), sqrt(1/CN))\n  r.mut = cor(sqrt(d.mut$mean.SD), sqrt(1/CN))\n\n  # plots\n  par(pty = \"s\")\n\n  plot(y = (sqrt(d.exp$mean.SD)), x = sqrt(1/CN), ylab = \"sqrt <SDi> experimental\", xlab = \"sqrt 1/CNi\")\n  lm = lm((sqrt(d.exp$mean.SD)) ~ sqrt(1/CN))\n  legend(\"topleft\", paste (\"r = \", round(r.exp, digits = 2)), bty = \"n\")\n\n  plot(y = (sqrt(d.mut$mean.SD)), x = sqrt(1/CN), ylab = \"sqrt <SDi> no-selection\", xlab = \"sqrt 1/CNi\", main = family) \n  lm = lm(sqrt(d.mut$mean.SD) ~ sqrt(1/CN))\n  legend(\"topleft\", paste (\"r = \", round(r.mut, digits = 2)), bty = \"n\")\n\n  plot(y = (sqrt(d.medium$mean.SD)), x = sqrt(1/CN), ylab = \"sqrt <SDi> selection\", xlab =   \"sqrt 1/CNi\")\n  lm = lm(sqrt(d.medium$mean.SD) ~ sqrt(1/CN))\n legend(\"topleft\", paste (\"r = \", round(r.medium, digits = 2)), bty = \"n\")\n}\n```\n\n## (exp SDi vs theo SDi) vs  n.sites or n.prot\n```{r plot-sqrt-SDi-n.sites-n.prot, fig.height=7, fig.width=7}\n\nv.r.exp.mut = c()\nv.r.exp.medium = c()\nv.r.mut.medium = c()\n\nv.n.sites = c()\nv.n.prot = c()\n\n  # satart a loop for each family\nfor (f in (1:nrow(input))) { \n  family <- as.character(input$family)[f]\n  p.ref <- as.character(input$p.ref)[f]\n\n  d = read.csv(file.path(data.dir, paste(family, \"_\", p.ref, \"_R0_\", R0, \"d.SD.csv\", sep = \"\")))\n  protein_list = read.csv(file.path(data.dir, paste(family, \"_list.txt\", sep = \"\")))\n  n.prot = nrow(protein_list)\n  n.sites = nrow(subset(d, dataset == \"exp\"))\n  \n  v.n.prot = c(v.n.prot, n.prot)\n  v.n.sites = c(v.n.sites, n.sites)\n\n  # get subsets\n  d.exp = subset(d, dataset == \"exp\")\n  d.mut = subset(d, dataset == \"no-selection\")\n  d.medium = subset(d, dataset == \"selection\")\n\n # calculate Pearson correlation\n  r.exp.mut = cor(sqrt(d.exp$mean.SD), sqrt(d.mut$mean.SD))\n  r.exp.medium = cor(sqrt(d.exp$mean.SD), sqrt(d.medium$mean.SD))\n  r.mut.medium = cor(sqrt(d.mut$mean.SD), sqrt(d.medium$mean.SD))\n\n  v.r.exp.mut = c(v.r.exp.mut, r.exp.mut)\n  v.r.exp.medium = c(v.r.exp.medium, r.exp.medium)\n  v.r.mut.medium = c(v.r.mut.medium, r.mut.medium)\n}\n\nlayout(matrix(1:6, 2, 3, byrow = T))\n\nplot(y = v.r.exp.mut, x = v.n.prot, ylab = \"r (sqrt SDi exp, sqrt SDi no-selection)\", xlab = \"n exp prot\", xlim = c(10, 50))\ntext(y = v.r.exp.mut, x = v.n.prot, input$family, cex=0.6, pos=4, col=\"black\")\nplot(y = v.r.exp.medium, x = v.n.prot, ylab = \"r (sqrt SDi exp, sqrt SDi selection)\", xlab = \"n exp prot\", xlim = c(10, 50))\ntext(y = v.r.exp.medium, x = v.n.prot, input$family, cex=0.6, pos=4, col=\"black\")\nplot(y = v.r.mut.medium, x = v.n.prot, ylab = \"r (sqrt SDi no-selection, sqrt SDi selection)\", xlab = \"n exp prot\", xlim = c(10, 50))\ntext(y = v.r.mut.medium, x = v.n.prot, input$family, cex=0.6, pos=4, col=\"black\")\n\nplot(y = v.r.exp.mut, x = v.n.sites, ylab = \"r (sqrt SDi exp, sqrt SDi no-selection)\", xlab = \"n sites p.ref\", xlim = c(50, 250))\ntext(y = v.r.exp.mut, x = v.n.sites, input$family, cex=0.6, pos=4, col=\"black\")\nplot(y = v.r.exp.medium, x = v.n.sites, ylab = \"r (sqrt SDi exp, sqrt SDi selection)\", xlab = \"n sites p.ref\", xlim = c(50, 250))\ntext(y = v.r.exp.medium, x = v.n.sites, input$family, cex=0.6, pos=4, col=\"black\")\nplot(y = v.r.mut.medium, x = v.n.sites, ylab = \"r (sqrt SDi no-selection, sqrt SDi selection)\", xlab = \"n sites p.ref\", xlim = c(50, 250))\ntext(y = v.r.mut.medium, x = v.n.sites, input$family, cex=0.6, pos=4, col=\"black\")\n\nlayout(matrix(1:1, 1, 1, byrow = T))\nplot(y = v.n.sites, x = v.n.prot, ylab = \"n sites p.ref\", xlab = \"n exp prot\", xlim = c(10, 50))\ntext(y = v.n.sites, x = v.n.prot, input$family, cex=0.6, pos=4, col=\"black\")\n```\n\n## (exp SDi vs theo SDi) vs  (exp SDi vs LPD)\n```{r comparison-LPD-SDi, fig.height=6, fig.width=12}\n\nv.r.exp.mut = c()\nv.r.exp.medium = c()\nv.r.mut.medium = c()\n\nCA.cor.p.sqrt = c()\n\n# satart a loop for each family\nfor (f in (1:nrow(input))) { \n  family <- as.character(input$family)[f]\n  p.ref <- as.character(input$p.ref)[f]\n\n  d = read.csv(file.path(data.dir, paste(family, \"_\", p.ref, \"_R0_\", R0, \"d.SD.csv\", sep = \"\")))\n  protein_list = read.csv(file.path(data.dir, paste(family, \"_list.txt\", sep = \"\")))\n  n.prot = nrow(protein_list)\n  n.sites = nrow(subset(d, dataset == \"exp\"))\n  \n  v.n.prot = c(v.n.prot, n.prot)\n  v.n.sites = c(v.n.sites, n.sites)\n\n  # get subsets\n  d.exp = subset(d, dataset == \"exp\")\n  d.mut = subset(d, dataset == \"no-selection\")\n  d.medium = subset(d, dataset == \"selection\")\n\n  # calculate Pearson correlation\n  r.exp.mut = cor(sqrt(d.exp$mean.SD), sqrt(d.mut$mean.SD))\n  r.exp.medium = cor(sqrt(d.exp$mean.SD), sqrt(d.medium$mean.SD))\n  r.mut.medium = cor(sqrt(d.mut$mean.SD), sqrt(d.medium$mean.SD))\n\n  v.r.exp.mut = c(v.r.exp.mut, r.exp.mut)\n  v.r.exp.medium = c(v.r.exp.medium, r.exp.medium)\n  v.r.mut.medium = c(v.r.mut.medium, r.mut.medium)\n  \n  # read the data frame\n  cc = read.csv(file = file.path(\"CORRELATIONS\", paste(family, \"_out_cc_R0s.csv\", sep = \"\")))\n  \n  # get CA and CM pearson sqrt cc for f\n  CA.cor.p.sqrt = c(CA.cor.p.sqrt, cc$CA.pearson.sqrt[4]) # it might be changed (4 corresponds to R0 = 12.5)\n}\n\nlayout(matrix(1:2, 1, 2, byrow = T))\n\npar(pty = \"s\")\n \nplot(y = v.r.exp.mut, x = CA.cor.p.sqrt, ylab = \"r (sqrt SDi exp, sqrt SDi no-selection)\", xlab = \"r (sqrt SDi exp, sqrt 1/CN)\", xlim = c(0.5, 1), ylim = c(0.5, 1))\ntext(y = v.r.exp.mut, x = CA.cor.p.sqrt, input$family, cex=0.6, pos=4, col=\"black\")\nabline(0,1)\nlegend(\"topleft\", paste (\"r = \", round(cor(y = v.r.exp.mut, x = CA.cor.p.sqrt), digits = 2)), bty = \"n\")\n\nplot(y = v.r.exp.medium, x = CA.cor.p.sqrt, ylab = \"r (sqrt SDi exp, sqrt SDi selection)\", xlab = \"r (sqrt SDi exp, sqrt 1/CN)\", xlim = c(0.5, 1), ylim = c(0.5, 1))\ntext(y = v.r.exp.medium, x = CA.cor.p.sqrt, input$family, cex=0.6, pos=4, col=\"black\")\nabline(0,1)\nlegend(\"topleft\", paste (\"r = \", round(cor(y = v.r.exp.medium, x = CA.cor.p.sqrt), digits = 2)), bty = \"n\")\n\n```",
    "created" : 1510451336029.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "396405976",
    "id" : "C80FD658",
    "lastKnownWriteTime" : 1511531491,
    "last_content_update" : 1511531491475,
    "path" : "C:/Users/MarÃ­a Laura/Desktop/proteins_structural_variability_git/figures2_structure_all_families.Rmd",
    "project_path" : "figures2_structure_all_families.Rmd",
    "properties" : {
        "last_setup_crc32" : "2AD02B31c223148f"
    },
    "relative_order" : 8,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}
"0","# read experimental data obtained from ConsurfDB"
"0","consurf = read.csv(score.fname, sep = "";"")"
"0","score = consurf$SCORE"
"0","# read simulated data"
"0","## no sel"
"0","sim.data.mut = read.csv(sim.data.mut.fname)"
"0","mut.site.mut = sim.data.mut$site"
"0","accept.mut = sim.data.mut$accept"
"0","## medium sel"
"0","sim.data.medium.sel = read.csv(sim.data.medium.sel.fname)"
"0","mut.site.medium.sel = sim.data.medium.sel$site"
"0","accept.medium.sel = sim.data.medium.sel$accept"
"0","# calculate p.accept of simulated data"
"0","p.accept.mut = c()"
"0","p.accept.medium.sel = c()"
"0","# correct indexes"
"0","if (data.dir == ""OUT/out_subset_CM_ANM"") {"
"0","  mut.site.mut = mut.site.mut - n.sites"
"0","  mut.site.medium.sel = mut.site.medium.sel - n.sites"
"0","  CN.CM = sim.data.mut$CN"
"0","  CN = c()"
"0","  for (i in (1:n.sites)) {"
"0","    CN[i] = CN.CM[which(mut.site.mut == i)][1]"
"0","  }"
"0","}"
"0","  "
"0","for (i in (1:n.sites)) {"
"0","  accept.mut.i = accept.mut[which(mut.site.mut == i)]"
"0","  p.accept.mut.i = mean(accept.mut.i)"
"0","  p.accept.mut[i] = p.accept.mut.i"
"0","  "
"0","  accept.medium.sel.i = accept.medium.sel[which(mut.site.medium.sel == i)]"
"0","  p.accept.medium.sel.i = mean(accept.medium.sel.i)"
"0","  p.accept.medium.sel[i] = p.accept.medium.sel.i"
"0","}"
"0","# compare exp vs no sel profiles"
"0","## plot"
"0","par(pty = ""s"")"
"2","Error in (function (filename = ""Rplot%03d.png"", width = 480, height = 480,  : 
  unable to start png() device
"

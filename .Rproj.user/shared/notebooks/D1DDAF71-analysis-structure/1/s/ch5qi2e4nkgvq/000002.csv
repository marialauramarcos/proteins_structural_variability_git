"0","# prepare the data"
"0","## exp"
"0","tdri2.exp = as.data.frame(t(as.matrix(dri2.exp)))"
"0","tdri2.exp = cbind(site.info, tdri2.exp)"
"0","siteComparison.exp = melt(tdri2.exp, id.vars = names(site.info), variable.name = ""protein"", value.name = ""dri2"")"
"0","## mut"
"0","tdri2.mut = as.data.frame(t(as.matrix(dri2.mut)))"
"0","tdri2.mut = cbind(site.info, tdri2.mut)"
"0","siteComparison.mut = melt(tdri2.mut, id.vars = names(site.info), variable.name = ""protein"", value.name = ""dri2"")"
"0","## medium"
"0","tdri2.medium = as.data.frame(t(as.matrix(dri2.medium)))"
"0","tdri2.medium = cbind(site.info, tdri2.medium)"
"0","siteComparison.medium = melt(tdri2.medium, id.vars = names(site.info), variable.name = ""protein"", value.name = ""dri2"")"
"0","# bluild the data.frame"
"0","siteComparison.all.datasets = rbind(data.frame(""dataset"" = ""exp"", siteComparison.exp),"
"0","                                    data.frame(""dataset"" = ""mut"", siteComparison.mut),"
"0","                                    data.frame(""dataset"" = ""medium"", siteComparison.medium))"
"0","siteComparison.all.datasets = ddply(siteComparison.all.datasets, c(""dataset"", ""protein""), mutate,"
"0","          ""n.SD"" = dri2/mean(dri2, na.rm = T),"
"0","          ""z.SD"" = vscale(dri2),"
"0","          ""RSD"" = sqrt(dri2), "
"0","          ""n.RSD"" = RSD/mean(RSD, na.rm = T),"
"0","          ""z.RSD"" = vscale(RSD))"
